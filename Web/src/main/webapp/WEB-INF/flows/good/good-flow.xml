<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
	  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	  xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd"
		parent="global">

	<input name="goodId" required="true" type="long" />

	<on-start>
		<evaluate expression="productDao.findById(goodId)" result="flowScope.product"/>
        <evaluate expression="utils.asList(product.images)" result="flowScope.imagesList" result-type="dataModel"/>
	</on-start>
	<view-state id="good">
        <transition on="hitImage">
            <set name="flashScope.selectedImage" value="imagesList.selectedRow"/>
            <render fragments="bigPicture"/>
        </transition>
	</view-state>

	<end-state id="end"/>
</flow>