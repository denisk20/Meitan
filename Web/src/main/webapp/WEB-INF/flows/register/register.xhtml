<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	    		xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:sf="http://www.springframework.org/tags/faces"
				xmlns:c="http://java.sun.com/jstl/core"
				xmlns:j4j="http://javascript4jsf.dev.java.net/"
				template="/WEB-INF/templates/meitan-subflow.xhtml">

<ui:define name="content">

<h1>Registration page</h1>
<div class="section">
	<h:messages/>
	<h:form id="registeringForm">
		<h:outputLabel for="firstName" value="First name"/>
		<sf:clientTextValidator promptMessage="Enter the first name">
				<h:inputText id="firstName" value="#{newClient.name.firstName}"/>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="patronymic" value="Patronymic"/>
		<sf:clientTextValidator promptMessage="Enter the patronymic">
				<h:inputText id="patronymic" value="#{newClient.name.patronymic}"/>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="secondName" value="Second name"/>
		<sf:clientTextValidator promptMessage="Enter the second name">
				<h:inputText id="secondName" value="#{newClient.name.secondName}"/>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="emailAddress" value="Email"/>
		<!--todo the validator doesn't work.... must figure out why-->
		<sf:clientTextValidator regExp="[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}" promptMessage="Enter email" required="true" invalidMessage="Your email isn't valid">
			<h:inputText id="emailAddress" value="#{newClient.email}" required="true"/>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="notes" value="Notes"/>
		<sf:clientTextValidator promptMessage="Additional notes">
			<h:inputText id="notes" value="#{newClient.notes}"/>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="login" value="Login"/>
		<sf:clientTextValidator promptMessage="Choose your login">
			<h:inputText id="login" value="#{newClient.login}"/>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="pass" value="Password"/>
		<sf:clientTextValidator promptMessage="Choose your password">
			<h:inputText id="pass" value="#{newClient.password}">
				<j4j:idProxy id="origPass"/>
			</h:inputText>
		</sf:clientTextValidator>
		<br/>

		<h:outputLabel for="conformPass" value="re-type Password"/>
		<sf:clientTextValidator promptMessage="Re-type your password">
			<h:inputText id="conformPass" value="#{newClient.conformedPassword}">
				<j4j:idProxy id="conformedPass"/>
			</h:inputText>
		</sf:clientTextValidator>
		<br/>


		<!--todo replace this with the call of net.tanesha.recaptcha.ReCaptchaImpl.createRecaptchaHtml-->
		<script type="text/javascript" src="http://api.recaptcha.net/challenge?k=6LcTPLsSAAAAAGxZPlc-ho30s-GlcYREXPM3sAzx">
		</script>
		<noscript>
			<iframe src="http://api.recaptcha.net/noscript?k=6LcTPLsSAAAAAGxZPlc-ho30s-GlcYREXPM3sAzx"
					height="300" width="500" frameborder="0"></iframe><br/>
			<textarea name="recaptcha_challenge_field" rows="3" cols="40">
			</textarea>
			<input type="hidden" name="recaptcha_response_field"
				   value="manual_challenge"/>
		</noscript>

		<script type="text/javascript">
/*
			function validatePasswords() {
				return false;
				var passRealId=document.getElementById("origPass").title;
				var confPassRealId=document.getElementById("conformedPass").title;

				var passComponent = document.getElementById(passRealId);
				var conformedPassComponent = document.getElementById(confPassRealId);

				if(! (passComponent.value == conformedPassComponent.value)) {
					alert("Passwords doesn't match");
					return false;
				}
				return true;
			}
*/

		</script>
		<!--todo this doesn't work-->
		<sf:commandButton value="Register!" action="register" processIds="*" />
		<sf:commandButton value="Cancel" action="cancel" />
	</h:form>
</div>


</ui:define>
</ui:composition>